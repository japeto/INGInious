var PythonTutor=function(){function e(e,t){this.defaultVisualServer=getDefaultVisualServerURL(),this.javaVisualServer="https://cscircles.cemc.uwaterloo.ca/",this.python2VisualServer=getPython2VisualServerURL(),this.problemId=e,this.code=codeEditors[e].getValue(),"plain"==t&&(t=getLanguageForProblemId(this.problemId)),"python"==t&&(t=getInginiousLanguageForProblemId(this.problemId)),this.language=t,this.input=document.getElementById("custominput-"+this.problemId).value}return e.prototype.visualize=function(){var e=this.createIFrameFromCode();this.showIFrameIntoModal(e)},e.prototype.createIFrameFromCode=function(){var e=document.createElement("iframe");return e.src=this.generateVisualizerUrl(),e.height="400px",e.width="100%",e.frameborder="0",e},e.prototype.showIFrameIntoModal=function(e){var t=document.getElementById("modal-"+this.problemId).getElementsByClassName("modal-body")[0];$(t).empty(),t.innerHTML="Plase wait while we excecute your code, this may take up to 10 seconds",t.appendChild(e)},e.prototype.generateVisualizerUrl=function(){return"java"==this.language?this.generateJavaUrl():this.generateGenericUrl()},e.prototype.generateJavaUrl=function(){var e={user_script:this.code,options:{showStringsAsValues:!0,showAllFields:!1},args:[],stdin:this.input};return this.serverResource()+window.encodeURIComponent(JSON.stringify(e))+"&cumulative=false&heapPrimitives=false&drawParentPointers=false&textReferences=false&showOnlyOutputs=false&py=3&curInstr=0&resizeContainer=true&highlightLines=true&rightStdout=true&codeDivHeight=450&codeDivWidth=500"},e.prototype.generateGenericUrl=function(){var e=window.encodeURIComponent(this.code);return this.serverResource()+e+"&mode=edit&py="+this.languageURIName()+"&codeDivHeight=450&codeDivWidth=500&rawInputLstJSON="+this.encodedInputArray()},e.prototype.serverResource=function(){return"java"==this.language?this.javaVisualServer+"java_visualize/iframe-embed.html?faking_cpp=false#data=":"python2"==this.language?this.python2VisualServer+"iframe-embed.html#code=":this.defaultVisualServer+"iframe-embed.html#code="},e.prototype.languageURIName=function(){return"javascript"==this.language?"js":"python2"==this.language?"2":"python3"==this.language?"3":this.language},e.prototype.encodedInputArray=function(){var e=this.input.split("\n");return window.encodeURIComponent(JSON.stringify(e))},e}();function visualizeCode(e,t){var n=new PythonTutor(t,e);$.post("/api/analytics/",{service:{key:"python_tutor",name:"Python tutor"},course_id:getCourseId()}),n.visualize()}function convertInginiousLanguageToLinter(e){return{java7:"java",java8:"java",js:"javascript",cpp:"cpp",cpp11:"cpp",c:"c",c11:"c",python2:"python2",python3:"python3",ruby:"ruby"}[e]}function webLinter(e,t,n,o){var i=convertInginiousLanguageToLinter(o.getOption("inginiousLanguage")),r=getLinterServerURL()+i;$.post(r,{code:e},function(e,n){var o=JSON.parse(e);t(o)})}!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("lint","python",webLinter),e.registerHelper("lint","text/x-java",webLinter),e.registerHelper("lint","text/x-c++src",webLinter),e.registerHelper("lint","text/x-csrc",webLinter)}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";const t="CodeMirror-lint-markers";function n(e){e.parentNode&&e.parentNode.removeChild(e)}function o(t,o,i){let r=function(t,n){const o=document.createElement("div");function i(t){if(!o.parentNode)return e.off(document,"mousemove",i);o.style.top=Math.max(0,t.clientY-o.offsetHeight-5)+"px",o.style.left=t.clientX+5+"px"}return o.className="CodeMirror-lint-tooltip",o.appendChild(n.cloneNode(!0)),document.body.appendChild(o),e.on(document,"mousemove",i),i(t),null!=o.style.opacity&&(o.style.opacity=1),o}(t,o);function a(){var t;e.off(i,"mouseout",a),r&&((t=r).parentNode&&(null==t.style.opacity&&n(t),t.style.opacity=0,setTimeout(function(){n(t)},600)),r=null)}const s=setInterval(function(){if(r)for(let e=i;;e=e.parentNode){if(e&&11===e.nodeType&&(e=e.host),e===document.body)return;if(!e){a();break}}if(!r)return clearInterval(s)},400);e.on(i,"mouseout",a)}function i(e,t,n){this.marked=[],this.options=t,this.timeout=null,this.hasGutter=n,this.onMouseOver=function(t){!function(e,t){const n=t.target||t.srcElement;if(!/\bCodeMirror-lint-mark-/.test(n.className))return;const i=n.getBoundingClientRect(),r=(i.left+i.right)/2,a=(i.top+i.bottom)/2,u=e.findMarksAt(e.coordsChar({left:r,top:a},"client")),l=[];for(let e=0;e<u.length;++e){const t=u[e].__annotation;t&&l.push(t)}l.length&&function(e,t){const n=t.target||t.srcElement,i=document.createDocumentFragment();for(let t=0;t<e.length;t++){let n=e[t];i.appendChild(s(n))}o(t,i,n)}(l,t)}(e,t)},this.waitingFor=0}function r(e){const n=e.state.lint;n.hasGutter&&e.clearGutter(t);for(let e=0;e<n.marked.length;++e)n.marked[e].clear();n.marked.length=0}function a(t,n,i,r){let a=document.createElement("div"),s=a;return a.className="CodeMirror-lint-marker-"+n,i&&((s=a.appendChild(document.createElement("div"))).className="CodeMirror-lint-marker-multiple"),!1!==r&&e.on(s,"mouseover",function(e){o(e,t,s)}),a}function s(e){let t=e.severity;t||(t="error");const n=document.createElement("div");return n.className="CodeMirror-lint-message-"+t,void 0!==e.messageHTML?n.innerHTML=e.messageHTML:n.appendChild(document.createTextNode(e.message)),n}function u(t){const n=t.state.lint.options,o=n.options||n,i=n.getAnnotations||t.getHelper(e.Pos(0,0),"lint");if(i)if(n.async||i.async)!function(t,n,o){const i=t.state.lint;let r=++i.waitingFor;function a(){r=-1,t.off("change",a)}t.on("change",a),n(t.getValue(),function(n,o){t.off("change",a),i.waitingFor===r&&(o&&n instanceof e&&(n=o),t.operation(function(){l(t,n)}))},o,t)}(t,i,o);else{const e=i(t.getValue(),o,t);if(!e)return;e.then?e.then(function(e){t.operation(function(){l(t,e)})}):t.operation(function(){l(t,e)})}}function l(e,n){r(e);const o=e.state.lint,i=o.options,u=function(e){const t=[];for(let n=0;n<e.length;++n){const o=e[n],i=o.from.line;(t[i]||(t[i]=[])).push(o)}return t}(n);for(let n=0;n<u.length;++n){const r=u[n];if(!r)continue;let p=null;const d=o.hasGutter&&document.createDocumentFragment();for(let t=0;t<r.length;++t){let n=r[t],a=n.severity;a||(a="error"),c=a,p="error"===(l=p)?l:c,i.formatAnnotation&&(n=i.formatAnnotation(n)),o.hasGutter&&d.appendChild(s(n)),n.to&&o.marked.push(e.markText(n.from,n.to,{className:"CodeMirror-lint-mark-"+a,__annotation:n}))}o.hasGutter&&e.setGutterMarker(n,t,a(d,p,r.length>1,o.options.tooltips))}var l,c;i.onUpdateLinting&&i.onUpdateLinting(n,u,e)}function c(e){const t=e.state.lint;t&&(clearTimeout(t.timeout),t.timeout=setTimeout(function(){u(e)},t.options.delay||5e3))}e.defineOption("lint",!1,function(n,o,a){if(a&&a!==e.Init&&(r(n),!1!==n.state.lint.options.lintOnChange&&n.off("change",c),e.off(n.getWrapperElement(),"mouseover",n.state.lint.onMouseOver),clearTimeout(n.state.lint.timeout),delete n.state.lint),o){const r=n.getOption("gutters");let a=!1;for(let e=0;e<r.length;++e)r[e]===t&&(a=!0);const l=n.state.lint=new i(n,(s=o)instanceof Function?{getAnnotations:s}:(s&&!0!==s||(s={}),s),a);!1!==l.options.lintOnChange&&n.on("change",c),!1!==l.options.tooltips&&"gutter"!==l.options.tooltips&&e.on(n.getWrapperElement(),"mouseover",l.onMouseOver),u(n)}var s}),e.defineExtension("performLint",function(){this.state.lint&&u(this)})});